var canvas = document.querySelector("#scene"), ctx = canvas.getContext("2d"), particles = [], amount = 0, mouse = { x: 0, y: 0 }, radius = 1, colors = ["#468966", "#FFF0A5", "#FFB03B", "#B64926", "#8E2800"], copy = document.querySelector("#copy"), ww = canvas.width = window.innerWidth, wh = canvas.height = window.innerHeight; function Particle(t, e) { this.x = Math.random() * ww, this.y = Math.random() * wh, this.dest = { x: t, y: e }, this.r = 5 * Math.random() + 2, this.vx = 20 * (Math.random() - .5), this.vy = 20 * (Math.random() - .5), this.accX = 0, this.accY = 0, this.friction = .05 * Math.random() + .94, this.color = colors[Math.floor(6 * Math.random())] } function onMouseMove(t) { mouse.x = t.clientX, mouse.y = t.clientY } function onTouchMove(t) { t.touches.length > 0 && (mouse.x = t.touches[0].clientX, mouse.y = t.touches[0].clientY) } function onTouchEnd(t) { mouse.x = -9999, mouse.y = -9999 } function initScene() { ww = canvas.width = window.innerWidth, wh = canvas.height = window.innerHeight, ctx.clearRect(0, 0, canvas.width, canvas.height), ctx.font = "bold " + ww / 10 + "px sans-serif", ctx.textAlign = "center", ctx.fillText(copy.value, ww / 2, wh / 2); var t = ctx.getImageData(0, 0, ww, wh).data; ctx.clearRect(0, 0, canvas.width, canvas.height), ctx.globalCompositeOperation = "screen", particles = []; for (var e = 0; e < ww; e += Math.round(ww / 150))for (var i = 0; i < wh; i += Math.round(ww / 150))t[4 * (e + i * ww) + 3] > 150 && particles.push(new Particle(e, i)); amount = particles.length } function onMouseClick() { 5 === ++radius && (radius = 0) } function render(t) { requestAnimationFrame(render), ctx.clearRect(0, 0, canvas.width, canvas.height); for (var e = 0; e < amount; e++)particles[e].render() } Particle.prototype.render = function () { this.accX = (this.dest.x - this.x) / 1e3, this.accY = (this.dest.y - this.y) / 1e3, this.vx += this.accX, this.vy += this.accY, this.vx *= this.friction, this.vy *= this.friction, this.x += this.vx, this.y += this.vy, ctx.fillStyle = this.color, ctx.beginPath(), ctx.arc(this.x, this.y, this.r, 2 * Math.PI, !1), ctx.fill(); var t = this.x - mouse.x, e = this.y - mouse.y; Math.sqrt(t * t + e * e) < 70 * radius && (this.accX = (this.x - mouse.x) / 100, this.accY = (this.y - mouse.y) / 100, this.vx += this.accX, this.vy += this.accY) }, copy.addEventListener("keyup", initScene), window.addEventListener("resize", initScene), window.addEventListener("mousemove", onMouseMove), window.addEventListener("touchmove", onTouchMove), window.addEventListener("click", onMouseClick), window.addEventListener("touchend", onTouchEnd), initScene(), requestAnimationFrame(render);